import{useRpc as de,send as ge,message as he}from"@koishijs/client";import{defineComponent as ye,inject as me,computed as be,resolveComponent as I,openBlock as ee,createElementBlock as ve,Fragment as we,renderList as xe,createBlock as Oe,withCtx as Ae,createVNode as Se,unref as Ce,h as M}from"vue";var _e=Object.defineProperty,d=(e,n)=>_e(e,"name",{value:n,configurable:true});function je(){}d(je,"noop");function j(e){return e==null}d(j,"isNullable");function De(e){return e&&typeof e=="object"&&!Array.isArray(e)}d(De,"isPlainObject");function $e(e,n){return Object.fromEntries(Object.entries(e).filter(([s,p])=>n(s,p)))}d($e,"filterKeys");function re(e,n){return Object.fromEntries(Object.entries(e).map(([s,p])=>[s,n(p,s)]))}d(re,"mapValues");function $(e,n){return arguments.length===1?s=>$(e,s):e in globalThis&&n instanceof globalThis[e]||Object.prototype.toString.call(n).slice(8,-1)===e}d($,"is");function W(e){return!e||typeof e!="object"?e:Array.isArray(e)?e.map(W):$("Date",e)?new Date(e.valueOf()):$("RegExp",e)?new RegExp(e.source,e.flags):re(e,W)}d(W,"clone");function K(e,n,s){if(e===n||!s&&j(e)&&j(n))return true;if(typeof e!=typeof n||typeof e!="object"||!e||!n)return false;function p(h,w){return h(e)?h(n)?w(e,n):false:h(n)?false:void 0}return d(p,"check"),p(Array.isArray,(h,w)=>h.length===w.length&&h.every((C,o)=>K(C,w[o])))??p($("Date"),(h,w)=>h.valueOf()===w.valueOf())??p($("RegExp"),(h,w)=>h.source===w.source&&h.flags===w.flags)??Object.keys({...e,...n}).every(h=>K(e[h],n[h],s))}d(K,"deepEqual");function ke(e,n,s){if(!n)return{...e};const p={};for(const h of n)(s||e[h]!==void 0)&&(p[h]=e[h]);return p}d(ke,"pick");function ze(e,n){if(!n)return{...e};const s={...e};for(const p of n)Reflect.deleteProperty(s,p);return s}d(ze,"omit");function Z(e,n,s){return Object.defineProperty(e,n,{writable:true,value:s,enumerable:false})}d(Z,"defineProperty");function Ne(e,n){return n.every(s=>e.includes(s))}d(Ne,"contain");function Fe(e,n){return e.filter(s=>n.includes(s))}d(Fe,"intersection");function Be(e,n){return e.filter(s=>!n.includes(s))}d(Be,"difference");function Re(e,n){return Array.from(new Set([...e,...n]))}d(Re,"union");function Me(e){return[...new Set(e)]}d(Me,"deduplicate");function Pe(e,n){const s=e.indexOf(n);return s>=0?(e.splice(s,1),true):false}d(Pe,"remove");function ne(e){return Array.isArray(e)?e:j(e)?[]:[e]}d(ne,"makeArray");function H(e){if(typeof Buffer<"u")return Buffer.from(e).toString("base64");let n="";const s=new Uint8Array(e);for(let p=0;p<s.byteLength;p++)n+=String.fromCharCode(s[p]);return btoa(n)}d(H,"arrayBufferToBase64");function Le(e){if(typeof Buffer<"u"){const p=Buffer.from(e,"base64");return new Uint8Array(p.buffer,p.byteOffset,p.length)}const n=atob(e.replace(/\s/g,"")),s=new Uint8Array(n.length);for(let p=0;p<n.length;p++)s[p]=n.charCodeAt(p);return s}d(Le,"base64ToArrayBuffer");function Ue(e){return e.charAt(0).toUpperCase()+e.slice(1)}d(Ue,"capitalize");function J(e){return e.charAt(0).toLowerCase()+e.slice(1)}d(J,"uncapitalize");function ie(e){return e.replace(/[_-][a-z]/g,n=>n.slice(1).toUpperCase())}d(ie,"camelCase");function ae(e){return J(e).replace(/_/g,"-").replace(/.[A-Z]+/g,n=>n[0]+"-"+n.slice(1).toLowerCase())}d(ae,"paramCase");function Ee(e){return J(e).replace(/-/g,"_").replace(/.[A-Z]+/g,n=>n[0]+"_"+n.slice(1).toLowerCase())}d(Ee,"snakeCase");var Ve=ie,Ye=ae;function oe(e){return e.replace(/\/$/,"")}d(oe,"trimSlash");function Ie(e){return e.startsWith("/")||(e="/"+e),oe(e)}d(Ie,"sanitize");var te;(e=>{e.millisecond=1,e.second=1e3,e.minute=e.second*60,e.hour=e.minute*60,e.day=e.hour*24,e.week=e.day*7;let n=new Date().getTimezoneOffset();function s(f){n=f}e.setTimezoneOffset=s,d(s,"setTimezoneOffset");function p(){return n}e.getTimezoneOffset=p,d(p,"getTimezoneOffset");function h(f=new Date,u){return typeof f=="number"&&(f=new Date(f)),u===void 0&&(u=n),Math.floor((f.valueOf()/e.minute-u)/1440)}e.getDateNumber=h,d(h,"getDateNumber");function w(f,u){const P=new Date(f*e.day);return u===void 0&&(u=n),new Date(+P+u*e.minute)}e.fromDateNumber=w,d(w,"fromDateNumber");const C=/\d+(?:\.\d+)?/.source,o=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map(f=>`(${C}${f})?`).join("")}$`);function c(f){const u=o.exec(f);return u?(parseFloat(u[1])*e.week||0)+(parseFloat(u[2])*e.day||0)+(parseFloat(u[3])*e.hour||0)+(parseFloat(u[4])*e.minute||0)+(parseFloat(u[5])*e.second||0):0}e.parseTime=c,d(c,"parseTime");function y(f){const u=c(f);return u?f=Date.now()+u:/^\d{1,2}(:\d{1,2}){1,2}$/.test(f)?f=`${new Date().toLocaleDateString()}-${f}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test(f)&&(f=`${new Date().getFullYear()}-${f}`),f?new Date(f):new Date}e.parseDate=y,d(y,"parseDate");function x(f){const u=Math.abs(f);return u>=e.day-e.hour/2?Math.round(f/e.day)+"d":u>=e.hour-e.minute/2?Math.round(f/e.hour)+"h":u>=e.minute-e.second/2?Math.round(f/e.minute)+"m":u>=e.second?Math.round(f/e.second)+"s":f+"ms"}e.format=x,d(x,"format");function A(f,u=2){return f.toString().padStart(u,"0")}e.toDigits=A,d(A,"toDigits");function _(f,u=new Date){return f.replace("yyyy",u.getFullYear().toString()).replace("yy",u.getFullYear().toString().slice(2)).replace("MM",A(u.getMonth()+1)).replace("dd",A(u.getDate())).replace("hh",A(u.getHours())).replace("mm",A(u.getMinutes())).replace("ss",A(u.getSeconds())).replace("SSS",A(u.getMilliseconds(),3))}e.template=_,d(_,"template")})(te||(te={}));var We=Object.defineProperty,Ke=Object.getOwnPropertyNames,m=(e,n)=>We(e,"name",{value:n,configurable:true}),Ze=(e,n)=>function(){return n||(0,e[Ke(e)[0]])((n={exports:{}}).exports,n),n.exports},He=Ze({"satori/packages/element/src/index.ts"(e,n){var C;var s=Symbol.for("satori.element"),p=(C=class{get data(){return this.attrs}getTagName(){var c;return this.type==="component"?((c=this.attrs.is)==null?void 0:c.name)??"component":this.type}toAttrString(){return Object.entries(this.attrs).map(([c,y])=>j(y)?"":(c=Ye(c),y===true?` ${c}`:y===false?` no-${c}`:` ${c}="${h.escape(""+y,true)}"`)).join("")}toString(c=false){if(this.type==="text"&&"content"in this.attrs)return c?this.attrs.content:h.escape(this.attrs.content);const y=this.children.map(_=>_.toString(c)).join("");if(c)return y;const x=this.toAttrString(),A=this.getTagName();return this.children.length?`<${A}${x}>${y}</${A}>`:`<${A}${x}/>`}},m(C,"ElementConstructor"),C);Z(p,"name","Element"),Z(p.prototype,s,true);function h(o,...c){const y=Object.create(p.prototype),x={},A=[];if(c[0]&&typeof c[0]=="object"&&!h.isElement(c[0])&&!Array.isArray(c[0])){const _=c.shift();for(const[f,u]of Object.entries(_))j(u)||(f==="children"?c.push(...ne(u)):x[Ve(f)]=u)}for(const _ of c)A.push(...h.toElementArray(_));return typeof o=="function"&&(x.is=o,o="component"),Object.assign(y,{type:o,attrs:x,children:A})}m(h,"Element");var w=new Function("expr","context",`
  try {
    with (context) {
      return eval(expr)
    }
  } catch {}
`);(o=>{o.jsx=o,o.jsxs=o,o.jsxDEV=o,o.Fragment="template";function c(r){return r&&typeof r=="object"&&r[s]}o.isElement=c,m(c,"isElement");function y(r){if(typeof r=="string"||typeof r=="number"||typeof r=="boolean"){if(r=""+r,r)return o("text",{content:r})}else{if(c(r))return r;if(!j(r))throw new TypeError(`Invalid content: ${r}`)}}o.toElement=y,m(y,"toElement");function x(r){return Array.isArray(r)?r.map(y).filter(t=>t):[y(r)].filter(t=>t)}o.toElementArray=x,m(x,"toElementArray");function A(r,t){return typeof r=="string"?k(r,t):x(r)}o.normalize=A,m(A,"normalize");function _(r,t=false){const i=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return t?i.replace(/"/g,"&quot;"):i}o.escape=_,m(_,"escape");function f(r){return r.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#(\d+);/g,(t,i)=>i==="38"?t:String.fromCharCode(+i)).replace(/&#x([0-9a-f]+);/gi,(t,i)=>i==="26"?t:String.fromCharCode(parseInt(i,16))).replace(/&(amp|#38|#x26);/g,"&")}o.unescape=f,m(f,"unescape");function u(r,t={}){var a;const i=k(r);return t.caret?t.type&&((a=i[0])==null?void 0:a.type)!==t.type?void 0:i[0]:R(i,t.type||"*")[0]}o.from=u,m(u,"from");const P=/ *([ >+~]) */g;function L(r){return r.split(",").map(t=>{const i=[];t=t.trim();let a,g=" ";for(;a=P.exec(t);)i.push({type:t.slice(0,a.index),combinator:g}),g=a[1],t=t.slice(a.index+a[0].length);return i.push({type:t,combinator:g}),i})}o.parseSelector=L,m(L,"parseSelector");function R(r,t){if(!r||!t)return[];if(typeof r=="string"&&(r=k(r)),typeof t=="string"&&(t=L(t)),!t.length)return[];let i=[];const a=[];for(const[g,l]of r.entries()){const b=[],S=[...t,...i];i=[];let O=false;for(const v of S){const{type:D,combinator:Y}=v[0];(D===l.type||D==="*")&&(v.length===1?O=true:[" ",">"].includes(v[1].combinator)?b.push(v.slice(1)):v[1].combinator==="+"?i.push(v.slice(1)):t.push(v.slice(1))),Y===" "&&b.push(v)}O&&a.push(r[g]),a.push(...R(l.children,b))}return a}o.select=R,m(R,"select");function F(r,t){if(r=r.trim(),!/^[\w.]+$/.test(r))return w(r,t)??"";let i=t;for(const a of r.split("."))if(i=i[a],j(i))return"";return i??""}o.interpolate=F,m(F,"interpolate");const se=/(?<comment><!--[\s\S]*?-->)|(?<tag><(\/?)([^!\s>/]*)([^>]*?)\s*(\/?)>)/,fe=/(?<comment><!--[\s\S]*?-->)|(?<tag><(\/?)([^!\s>/]*)([^>]*?)\s*(\/?)>)|(?<curly>\{(?<derivative>[@:/#][^\s}]*)?[\s\S]*?\})/,ue=/([^\s=]+)(?:="(?<value1>[^"]*)"|='(?<value2>[^']*)')?/g,ce=/([^\s=]+)(?:="(?<value1>[^"]*)"|='(?<value2>[^']*)'|=(?<curly>\{([^}]+)\}))?/g;let G;(r=>{r[r.OPEN=0]="OPEN",r[r.CLOSE=1]="CLOSE",r[r.EMPTY=2]="EMPTY",r[r.CONTINUE=3]="CONTINUE"})(G||(G={}));function k(r,t){const i=[];function a(O){O&&i.push(O)}m(a,"pushText");const g=t?fe:se;let l,b=true;for(;l=g.exec(r);){const O=!l.groups.curly;S(r.slice(0,l.index),b,O),b=O,r=r.slice(l.index+l[0].length);const[v,,,D,Y,le,pe]=l;if(!l.groups.comment){if(l.groups.curly){let q="",T=2;l.groups.derivative&&(q=l.groups.derivative.slice(1),T={"@":2,"#":0,"/":1,":":3}[l.groups.derivative[0]]),i.push({type:"curly",name:q,position:T,source:l.groups.curly,extra:l.groups.curly.slice(1+(l.groups.derivative??"").length,-1)});continue}i.push({type:"angle",source:v,name:Y||o.Fragment,position:D?1:pe?2:0,extra:le})}}S(r,b,true);function S(O,v,D){O=f(O),v&&(O=O.replace(/^\s*\n\s*/,"")),D&&(O=O.replace(/\s*\n\s*$/,"")),a(O)}return m(S,"parseContent"),z(Q(i),t)}o.parse=k,m(k,"parse");function Q(r){const t=[[{type:"angle",name:o.Fragment,position:0,source:"",extra:"",children:{default:[]}},"default"]];function i(...a){const[g,l]=t[0];g.children[l].push(...a)}m(i,"pushToken");for(const a of r){if(typeof a=="string"){i(a);continue}const{name:g,position:l}=a;l===1?t[0][0].name===g&&t.shift():l===3?(t[0][0].children[g]=[],t[0][1]=g):l===0?(i(a),a.children={default:[]},t.unshift([a,"default"])):i(a)}return t[t.length-1][0].children.default}m(Q,"foldTokens");function z(r,t){const i=[];for(const a of r)if(typeof a=="string")i.push(o("text",{content:a}));else if(a.type==="angle"){const g={},l=t?ce:ue;let b;for(;b=l.exec(a.extra);){const[,S,O,v=O,D]=b;D?g[S]=F(D,t):j(v)?S.startsWith("no-")?g[S.slice(3)]=false:g[S]=true:g[S]=f(v)}i.push(o(a.name,g,a.children&&z(a.children.default,t)))}else if(!a.name)i.push(...x(F(a.extra,t)));else if(a.name==="if")w(a.extra,t)?i.push(...z(a.children.default,t)):i.push(...z(a.children.else||[],t));else if(a.name==="each"){const[g,l]=a.extra.split(/\s+as\s+/),b=F(g,t);if(!b||!b[Symbol.iterator])continue;for(const S of b)i.push(...z(a.children.default,{...t,[l]:S}))}return i}m(z,"parseTokens");function U(r,t,i){const{type:a,attrs:g,children:l}=r;if(typeof t=="function")return t(r,i);{let b=t[typeof a=="string"?a:""]??t.default??true;return typeof b=="function"&&(b=b(g,l,i)),b}}m(U,"visit");function E(r,t,i){const a=typeof r=="string"?k(r):r,g=[];return a.forEach(l=>{const{type:b,attrs:S,children:O}=l,v=U(l,t,i);v===true?g.push(o(b,S,E(O,t,i))):v!==false&&g.push(...x(v))}),typeof r=="string"?g.join(""):g}o.transform=E,m(E,"transform");async function V(r,t,i){const a=typeof r=="string"?k(r):r,g=(await Promise.all(a.map(async l=>{const{type:b,attrs:S,children:O}=l,v=await U(l,t,i);return v===true?[o(b,S,await V(O,t,i))]:v!==false?x(v):[]}))).flat(1);return typeof r=="string"?g.join(""):g}o.transformAsync=V,m(V,"transformAsync");function B(r,...t){return(...i)=>{const a=o(r);return t.forEach((g,l)=>{j(i[l])||(a.attrs[g]=i[l])}),i[t.length]&&Object.assign(a.attrs,i[t.length]),a}}m(B,"createFactory"),o.warn=m(()=>{},"warn");function N(r){return(t,...i)=>{let a="base64://";return typeof i[0]=="string"&&(a=`data:${i.shift()};base64,`),$("Buffer",t)?t=a+t.toString("base64"):$("ArrayBuffer",t)?t=a+H(t):ArrayBuffer.isView(t)&&(t=a+H(t.buffer)),t.startsWith("base64://")&&(0,o.warn)('protocol "base64:" is deprecated and will be removed in the future, please use "data:" instead'),o(r,{...i[0],src:t})}}m(N,"createAssetFactory"),o.text=B("text","content"),o.at=B("at","id"),o.sharp=B("sharp","id"),o.quote=B("quote","id"),o.image=N("img"),o.img=N("img"),o.video=N("video"),o.audio=N("audio"),o.file=N("file");function X(r,t){return o("i18n",typeof r=="string"?{path:r}:r,t)}o.i18n=X,m(X,"i18n")})(h||(h={})),n.exports=h}});const Je=He(),Ge=ye({__name:"config",setup(e){const n=me("manager.settings.current"),s=de(),p=be(()=>s.value.notifiers.filter(C=>{var o;return((o=C.paths)==null?void 0:o.includes(n.value.path))&&C.content})),h=["div","ul","ol","li","br","span","p","img","audio","video","b","strong","i","em","u","ins","s","del","code"],w=({children:C},o)=>C.map(({type:c,attrs:y,children:x})=>{if(c==="text")return y.content;if(h.includes(c))return M(c,y,{default:()=>w({children:x})});if(c==="spl")return M("span",{class:"spoiler",...y},{default:()=>w({children:x})});if(c==="button")return M(I("el-button"),{...y,onClick:()=>ge("notifier/button",y.onClick)},{default:()=>w({children:x})});if(c==="progress")return M(I("el-progress"),y,{default:()=>w({children:x})});if(c==="template")return w({children:x})});return(C,o)=>{const c=I("k-comment");return ee(true),ve(we,null,xe(p.value,y=>(ee(),Oe(c,{type:y.type},{default:Ae(()=>[Se(w,{children:Ce(Je).parse(y.content)},null,8,["children"])]),_:2},1032,["type"]))),256)}}});const qe=e=>{e.slot({type:"plugin-details",component:Ge,order:0}),e.on("notifier/message",({content:n,type:s})=>{e.effect(()=>{const p=he({message:n,type:s==="primary"?"info":s});return()=>p.close()})})};export{qe as default};
